extends layout

block content
 script.
   function update(id){
    var req = new XMLHttpRequest();
    req.open("POST","/update");
    req.onreadystatechange = function(){
    if(req.readyState == 4){
     //window.location.reload(true);
     document.write(req.body.id);
    }
    }
    req.send(id);
   }
 if(item)
  p #{item.id} has #{item.price} price
 div.form-group
  form(name="list", method="post", action='/listing')
   input(type="text", name="keyword", size="10")
   input(type="submit", value="Search")
 table.table
  tbody
   if(list) 
    each li in list
     tr
      td
       img(src=li.PictureURL, height='250px', width='250px')
      td
       div.details
        p.price #{li.CurrentPrice.amount}
        p.sold #{li.QuantitySold}
        div.form-group
         form(name="update", method="post", action='/update')
          input(type="text", name="price", size="6")
          input(type="hidden", name="id", value=li.ItemID)
          input(type="submit", value="Update")
        a(target="_blank", href=li.ViewItemURLForNaturalSearch) #{li.Title}
        if(revise && revise.Ack != 'Failure' && revise.ItemID == li.ItemID)
         p.query #{revise.ItemID} updated successfully. 